function getWeek(e){const o=new Date(e.getFullYear(),0,1);return Math.ceil(((e-o)/864e5+o.getDay()+1)/7)}function setClock(e,o,t){document.getElementById("clockMins").innerText=e,document.getElementById("clockSecs").innerText=o,document.getElementById("clockSubHeading").innerText=t,document.getElementById("clockTime").ariaLabel="––"===e?"No time displayed":`${e} minutes and ${o} seconds left until the next period`}function SchoolPeriod(e,o,t){this.title=e,this.startTime=new Date,o=o.split(":"),this.startTime.setHours(o[0]),this.startTime.setMinutes(o[1]),this.startTime.setSeconds(0),this.endTime=new Date,t=t.split(":"),this.endTime.setHours(t[0]),this.endTime.setMinutes(t[1]),this.endTime.setSeconds(0),this.times=[this.startTime,this.endTime]}const periods={},timetable=[];function initPeriods(){periods.extendedMentor=[new SchoolPeriod("Period 1","8:40","9:40"),new SchoolPeriod("Period 2","9:40","10:40"),new SchoolPeriod("Mentor","11:05","11:35"),new SchoolPeriod("Period 3","11:35","12:35"),new SchoolPeriod("Period 4","12:40","13:40"),new SchoolPeriod("Period 5","14:30","15:30")],periods.gohome=[new SchoolPeriod("the holidays, please stop looking at this","00:01","23:59")],periods.assembly=[new SchoolPeriod("Assembly","8:30","9:30"),new SchoolPeriod("Period 2","9:55","10:55"),new SchoolPeriod("Period 3","11:20","12:20"),new SchoolPeriod("Period 4","12:20","13:20"),new SchoolPeriod("Period 5","14:20","15:20"),new SchoolPeriod("Period 6","14:35","15:30")],periods.coCurricular=[new SchoolPeriod("Period 1","8:40","9:35"),new SchoolPeriod("Period 2","9:40","10:40"),new SchoolPeriod("Period 3","11:00","12:00"),new SchoolPeriod("Period 4","12:00","13:00"),new SchoolPeriod("Co-curricular 1","13:30","14:30"),new SchoolPeriod("Co-curricular 2","14:30","15:30")],periods.standard=[new SchoolPeriod("Period 1","8:40","9:40"),new SchoolPeriod("Period 2","9:40","10:40"),new SchoolPeriod("Mentor","11:05","11:20"),new SchoolPeriod("Period 3","11:20","12:20"),new SchoolPeriod("Period 4","12:20","13:20"),new SchoolPeriod("Period 5","14:20","15:20")],timetable[0]=[periods.standard,periods.standard,periods.coCurricular,periods.standard,periods.standard],timetable[1]=[periods.standard,periods.standard,periods.coCurricular,periods.standard,periods.assembly]}function updateClock(){const e=new Date,o=getWeek(e)%2?1:0,t=document.getElementById("weekIndicator");t.innerText="Week "+(o?"A":"B"),t.setAttribute("data-week",o?"A":"B");let i=[];if(6===e.getDay()||0===e.getDay())return setClock("––","––","Relax, it's the weekend"),!1;i=timetable[o][e.getDay()-1];const r=e.getTime(),n=i.filter((e=>r<e.endTime.getTime()));if(0===n.length){setClock("––","––","Relax, the day is over");const o=new Date;return o.setHours(24),o.setMinutes(0),o.setSeconds(0),setTimeout(updateClock,o-e+2e3),setTimeout(initPeriods,o-e+1e3),!1}const d=n[0];let s,l;r<d.startTime.getTime()?(s=(d.startTime-e)/1e3,l=`Until ${d.title} starts`):(s=(d.endTime-e)/1e3,l=`Until the end of ${d.title}`);const a=Math.floor(s/3600);let c=Math.floor(s/60)%60,m=Math.floor(s%60);c+=60*a,c=String(c).padStart(2,"0"),m=String(m).padStart(2,"0"),setClock(`${c}:`,m,l),setTimeout(updateClock,500)}function setRandomBGImage(){const e=new URLSearchParams(window.location.search).get("cimg");if(null!==e)return document.body.style.backgroundImage=`url(${e})`,!1;const o=["./backgrounds/autumnal-peach-preview.png","./backgrounds/bright-rain-preview.png","./backgrounds/good-vibes-preview.png","./backgrounds/moonrise-preview.png","./backgrounds/rose-thorn-preview.png"],t=o[Math.floor(Math.random()*o.length)];document.body.style.backgroundImage=`url(${t})`}initPeriods(),updateClock(),setRandomBGImage();const alertElem=document.getElementById("alert");if(alertElem){const e=alertElem.dataset.alertId;"true"!==window.localStorage.getItem("isAlertClosed_"+e)&&(alertElem.style.display="flex"),document.getElementById("alertClose").addEventListener("click",(()=>{alertElem.style.display="none",window.localStorage.setItem("isAlertClosed_"+e,!0)}))}
